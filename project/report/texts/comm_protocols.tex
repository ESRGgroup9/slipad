\section{Communication Protocols}
% assim tudo misturado aqui dentro?
%********************************* LORAWAN *************************
\clearpage
\subsection{LoRaWAN}
LoRa (Long Range) is a radio modulation technology for wireless LAN networks in the category of \ac{lpwa} network technologies. LoRa was developed by Cycleo and later acquired by Semtech, the founding member of LoRa Alliance, an open, non-profit association that supports the LoRaWAN protocol. LoRaWAN is a network (protocol) using LoRa. \cite{lora_alliance}

LoRa technology uses the unlicensed frequency band (\ac{ism}), like 433~MHz, 868~MHz (in Europe), 915~MHz (in Australia and North America) and 923~MHz (in Asia). LoRa is the physical layer or the wireless modulation utilized to create a long range communication link, which may cover more than 10 km in line of sight. Many legacy wireless systems use \ac{fsk} modulation as the physical layer because it is a very efficient modulation for achieving low power. LoRa is based on \ac{css} modulation, which maintains the same low power characteristics as \ac{fsk} modulation but significantly increases the communication range, robustness to interference. LoRa is the first low cost implementation for commercial usage.

The LoRaWAN specification is a \ac{lpwa} networking protocol that targets key \ac{iot} requirements such as bi-directional communication, end-to-end security, mobility and localization services, whose baud rates range from 0,3~kbps to 50~kbps. LoRaWAN network architecture is deployed in a star-of-stars topology in which gateways relay messages between end-devices and a central network server. Each gateway is connected to the network server via standard IP connections, acting as a bridge by converting \ac{rf} packets to IP packets, and vice versa. The gateway only performs the forwarding of the data packets without any security protection. The end device communicates with one or more gateways by a single-hop LoRa or \ac{fsk}. LoRaWAN the protocol stack shown in figure \ref{fig:lorawan_stack}, remembering also figure \ref{fig:lora_device_classes}. \cite{what_is_lorawan}

\begin{figure}[H]
	\centering
	\includegraphics[width=.65\textwidth]{08theory/lorawan_stack}
	\caption{LoRaWAN protocol stack.}
	\label{fig:lorawan_stack}
\end{figure}

LoRa technology uses \ac{ism} bands, which brings vulnerability to the network. The attacker can listen on the address of the legal terminal and generate forged packets to the gateway to cause congestion. The attacker can also use his own LoRa device to send the maximum length preamble to occupy the channel maliciously. LoRaWAN considers network security issues in its design. LoRaWANâ€™s security policy is to encrypt data from the end device node to the network server and the application server. The former ensures that the legal node can access the network, authenticate the data packet, and perform integrity verification, and the latter ensures the end-to-end security of the application through the encryption of application data. \cite{lora_physical_layer}

\myparagraph{LoRa Frame Structure}
The LoRa frame structure is shown in figure \ref{fig:lora_packet_frame}, which comprises a preamble, an optional header and the data payload. LoRa employs two types o packet format: explicit and implicit. The explicit packet includes a short header containing information about the number of bytes, coding rate and whether a \ac{crc} is used in the packet.

\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{08theory/lora_packet_frame}
	\caption{LoRa frame structure.}
	\label{fig:lora_packet_frame}
\end{figure}

The preamble is used to keep the receiver synchronized with transmitter. The packet payload is a variable-length field that contains the actual data coded at the error rate either as specified in the header  in  explicit  mode  or  in  the  register  settings  in  implicit  mode. An  optional  CRC  may  be  appended. 

%********************************* SPI *************************
\clearpage
\subsection{SPI}

%********************************* I2C *************************
\subsection{I2C}

%********************************* CSI *************************
\subsection{CSI}
%by way of a 15 Pin Ribbon Cable, to the dedicated 15-pin MIPI Camera Serial Interface (CSI), which was designed especially for interfacing to cameras. The CSI bus is capable of extremely high data rates, and it exclusively carries pixel data to the BCM2835 processor. 

%********************************* TCP-IP *************************
\subsection{TCP-IP}

\subsection{HTTP}
\subsection{MQTT}