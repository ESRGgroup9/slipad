\hypertarget{index_8php_source}{}\doxysection{index.\+php}
\label{index_8php_source}\index{remoteSystem/website/index.php@{remoteSystem/website/index.php}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00001}00001 <?php}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00003}00003 \textcolor{comment}{// load secret variables}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00004}00004 require\_once \textcolor{stringliteral}{'vendor/autoload.php'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00005}00005 \$dotenv = \mbox{\hyperlink{class_dotenv_1_1_dotenv_a5f1fdbb31fb01c5381a81a41998eec82}{Dotenv\(\backslash\)Dotenv::createImmutable}}(\_\_DIR\_\_);}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00006}00006 \$dotenv-\/>load();}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00008}00008 \$servername =\$\_ENV[\textcolor{stringliteral}{'SERVER'}];}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00009}00009 \$username   =\$\_ENV[\textcolor{stringliteral}{'USERNAME'}];}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00010}00010 \$password   =\$\_ENV[\textcolor{stringliteral}{'PASSWORD'}];}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00011}00011 \$database   =\$\_ENV[\textcolor{stringliteral}{'DATABASE'}];}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00012}00012 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00013}00013 \$con = mysqli\_connect(\$servername, \$username, \$password, \$database);}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00015}00015 \textcolor{comment}{// Checking for connections}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00016}00016 \textcolor{keywordflow}{if} (\$con-\/>connect\_error) \{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00017}00017     die(\textcolor{stringliteral}{'Connect Error ('} . }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00018}00018     \$con-\/>connect\_errno . \textcolor{stringliteral}{') '}. }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00019}00019     \$con-\/>connect\_error);}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00020}00020 \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00022}00022 \textcolor{comment}{// create query to retrieve info about the location of parking spaces available}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00023}00023 \$query=}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00024}00024 \textcolor{stringliteral}{"{}SELECT latitude, longitude, l.post\_code, l.street\_name, p.num\_vacants, parish, county, district}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00025}00025 \textcolor{stringliteral}{FROM location l, parking\_space p, region r}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00026}00026 \textcolor{stringliteral}{WHERE l.id=p.id AND r.post\_code=l.post\_code AND p.id IN}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00027}00027 \textcolor{stringliteral}{  (SELECT id}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00028}00028 \textcolor{stringliteral}{  FROM parking\_space}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00029}00029 \textcolor{stringliteral}{  WHERE num\_vacants>=0)"{}};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00031}00031 \textcolor{comment}{// execute query}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00032}00032 \$result=mysqli\_query(\$con, \$query);}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00033}00033 ?>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00035}00035 <!DOCTYPE html>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00036}00036 <html lang=\textcolor{stringliteral}{"{}en"{}}>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00037}00037 <head>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00038}00038   <meta charset=\textcolor{stringliteral}{"{}UTF-\/8"{}}>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00039}00039   <meta name=\textcolor{stringliteral}{"{}viewport"{}} content=\textcolor{stringliteral}{"{}width=device-\/width, initial-\/scale=1.0"{}}>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00040}00040   <meta http-\/equiv=\textcolor{stringliteral}{"{}X-\/UA-\/Compatible"{}} content=\textcolor{stringliteral}{"{}ie=edge"{}}>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00041}00041   <title>SLiPaD</title>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00042}00042   <style>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00043}00043 \textcolor{preprocessor}{    \#map\{}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00044}00044       height:750px;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00045}00045       width:100\%;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00046}00046     \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00048}00048     footer \{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00049}00049       text-\/align: center;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00050}00050       \textcolor{comment}{/*padding: 0px;*/}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00051}00051       \textcolor{comment}{/*background-\/color: DarkSalmon;*/}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00052}00052       color: black;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00053}00053     \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00055}00055   </style>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00056}00056 </head>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00058}00058 <body>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00059}00059   <h1>SLiPaD</h1>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00060}00060   <h5>Smart Lighting with Parking Detection</h5>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00061}00061   <div \textcolor{keywordtype}{id}=\textcolor{stringliteral}{"{}map"{}}></div>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00062}00062   <script>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00064}00064     \textcolor{keyword}{function} initMap()\{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00065}00065       \textcolor{comment}{// Map options -\/ default zoom and center location}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00066}00066       var options = \{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00067}00067         zoom:17,}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00068}00068         center:\{lat:41.448259, lng:-\/8.298030\} , }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00069}00069       \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00071}00071       \textcolor{comment}{// New map}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00072}00072       var map = \textcolor{keyword}{new} google.maps.Map(document.getElementById(\textcolor{stringliteral}{'map'}), options);}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00074}00074        \textcolor{comment}{// Array of markers}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00075}00075       var markers = [];}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00077}00077       \textcolor{comment}{// fill array of markers}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00078}00078       \textcolor{comment}{// get latitude, longitude, post\_code, street\_name, num\_vacants, parish, county, district}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00079}00079       var j = 0;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00080}00080       <?php}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00081}00081       \textcolor{keywordflow}{while}(\$rows=\$result-\/>fetch\_assoc())}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00082}00082       \{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00083}00083       ?>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00084}00084         \textcolor{comment}{// get rows}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00085}00085         var latitude    =<?php echo \$rows[\textcolor{stringliteral}{'latitude'}] ?>;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00086}00086         var longitude   =<?php echo \$rows[\textcolor{stringliteral}{'longitude'}] ?>;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00087}00087         var post\_code   =\textcolor{stringliteral}{'<?php echo \$rows['}post\_code\textcolor{stringliteral}{'] ?>'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00088}00088         var street\_name =\textcolor{stringliteral}{'<?php echo \$rows['}street\_name\textcolor{stringliteral}{'] ?>'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00089}00089         var num\_vacants =<?php echo \$rows[\textcolor{stringliteral}{'num\_vacants'}] ?>;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00090}00090         var parish      =\textcolor{stringliteral}{'<?php echo \$rows['}parish\textcolor{stringliteral}{'] ?>'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00091}00091         var county      =\textcolor{stringliteral}{'<?php echo \$rows['}county\textcolor{stringliteral}{'] ?>'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00092}00092         var district    =\textcolor{stringliteral}{'<?php echo \$rows['}district\textcolor{stringliteral}{'] ?>'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00093}00093       }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00094}00094         var label =\textcolor{stringliteral}{'<h2>'}+num\_vacants+\textcolor{stringliteral}{' Available parking spots</h2>'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00095}00095             label+=\textcolor{stringliteral}{'<h3>'}+street\_name+\textcolor{stringliteral}{', '} +parish+\textcolor{stringliteral}{'</h3>'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00096}00096             label+=\textcolor{stringliteral}{'<h4>'}+county+\textcolor{charliteral}{' '}+post\_code+\textcolor{stringliteral}{'</h4>'};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00098}00098         markers[j] =}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00099}00099         \{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00100}00100           coords:\{lat:latitude, lng:longitude\},}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00101}00101           content:label}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00102}00102         \};}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00103}00103 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00104}00104         \textcolor{comment}{// fill next marker}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00105}00105         j++;}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00106}00106       <?php}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00107}00107       \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00108}00108       ?>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00110}00110       \textcolor{comment}{// Loop through markers}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00111}00111       \textcolor{keywordflow}{for}(var i = 0;i < markers.length;i++)\{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00112}00112         \textcolor{comment}{// Add marker}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00113}00113         addMarker(markers[i]);}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00114}00114       \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00116}00116       \textcolor{comment}{// Add Marker Function}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00117}00117       \textcolor{keyword}{function} addMarker(props)\{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00118}00118         var marker = \textcolor{keyword}{new} google.maps.Marker(\{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00119}00119           position:props.coords,}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00120}00120           map:map,}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00121}00121           \textcolor{comment}{//icon:props.iconImage}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00122}00122         \});}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00123}00123 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00124}00124         \textcolor{comment}{// Check for customicon}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00125}00125         \textcolor{comment}{// if(props.iconImage)\{}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00126}00126         \textcolor{comment}{//   // Set icon image}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00127}00127         \textcolor{comment}{//   marker.setIcon(props.iconImage);}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00128}00128         \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00130}00130         \textcolor{comment}{// Check content}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00131}00131         \textcolor{keywordflow}{if}(props.content)\{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00132}00132           var infoWindow = \textcolor{keyword}{new} google.maps.InfoWindow(\{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00133}00133             content:props.content}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00134}00134           \});}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00136}00136           marker.addListener(\textcolor{stringliteral}{'click'}, \textcolor{keyword}{function}()\{}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00137}00137             infoWindow.open(map, marker);}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00138}00138           \});}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00139}00139         \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00140}00140       \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00141}00141     \}}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00142}00142   </script>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00143}00143   <script async defer}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00144}00144     src=\textcolor{stringliteral}{"{}https://maps.googleapis.com/maps/api/js?key=<?php echo \$\_ENV['API\_KEY'] ?>\&callback=initMap"{}}>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00145}00145   </script>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00146}00146 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00147}00147   <footer>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00148}00148     <p><small>Tomás Abreu, Diogo Fernandes @ Universidade \textcolor{keywordflow}{do} Minho 2021</small><br>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00149}00149     <!-\/-\/ <a href=\textcolor{stringliteral}{"{}mailto:hege@example.com"{}}>hege@example.com</a></p> -\/-\/>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00150}00150   </footer>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00151}00151 }
\DoxyCodeLine{\Hypertarget{index_8php_source_l00152}00152 </body>}
\DoxyCodeLine{\Hypertarget{index_8php_source_l00153}00153 </html>}

\end{DoxyCode}
