\hypertarget{_c_character_dev_8cpp_source}{}\doxysection{CCharacter\+Dev.\+cpp}
\label{_c_character_dev_8cpp_source}\index{localSystem/src/CCharacterDev.cpp@{localSystem/src/CCharacterDev.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_c_character_dev_8h}{CCharacterDev.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00003}00003 \textcolor{preprocessor}{\#include <fcntl.h>}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include <sys/ioctl.h>}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00005}00005 \textcolor{preprocessor}{\#include <unistd.h>}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include "{}utils.h"{}}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00008}00008 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00010}00010 \textcolor{preprocessor}{\#define IOCTL\_PID 1}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00012}00012 CCharacterDev::CCharacterDev(\textcolor{keywordtype}{string} devName)}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00013}00013 \{}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00014}00014     pid\_t pid;}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00015}00015     }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00016}00016     this-\/>devStr = \textcolor{stringliteral}{"{}/dev/"{}} + devName;}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00017}00017     this-\/>dev = open(devStr.c\_str(), O\_RDWR);}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00019}00019     \textcolor{keywordflow}{if}(dev < 0)}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00020}00020     \{   }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00021}00021         panic(\textcolor{keywordtype}{string}(devStr + \textcolor{stringliteral}{"{}Device driver not found."{}}).c\_str())}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00022}00022     \}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00023}00023     }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00024}00024     pid = getpid();}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00025}00025     \textcolor{keywordflow}{if}(ioctl(dev, IOCTL\_PID, \&pid))}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00026}00026     \{}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00027}00027         close(dev);}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00028}00028         panic(\textcolor{keywordtype}{string}(devStr + \textcolor{stringliteral}{"{}Failed system call. Closing device driver."{}}).c\_str());}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00029}00029     \}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00030}00030 \}}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00032}00032 CCharacterDev::\string~CCharacterDev()}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00033}00033 \{}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00034}00034     close(dev);}
\DoxyCodeLine{\Hypertarget{_c_character_dev_8cpp_source_l00035}00035 \}}

\end{DoxyCode}
